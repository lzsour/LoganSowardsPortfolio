---
title: "YearlyTimeSeriesNationalPark"
author: "Logan Sowards"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

READ IN WASHINGTON MONUMENT DATA:
Annual visitors since 1936
Data downloaded 1/25/20

```{r}
washingtonMonument <- read.csv(header = TRUE, stringsAsFactors = FALSE, text = '
Year,RecreationVisitors,TotalRecreationVisitors
1936,"857,441","81,365,896"
1937,"998,686","81,365,896"
1938,"832,439","81,365,896"
1939,"927,543","81,365,896"
1940,"959,624","81,365,896"
1941,"965,689","81,365,896"
1942,"499,734","81,365,896"
1943,"472,004","81,365,896"
1944,"550,991","81,365,896"
1945,"608,667","81,365,896"
1946,"846,249","81,365,896"
1947,"794,813","81,365,896"
1948,"805,231","81,365,896"
1949,"867,327","81,365,896"
1950,"906,661","81,365,896"
1951,"962,000","81,365,896"
1952,"985,391","81,365,896"
1953,"1,022,269","81,365,896"
1954,"1,010,400","81,365,896"
1955,"1,039,900","81,365,896"
1956,"1,013,400","81,365,896"
1957,"1,143,100","81,365,896"
1958,"1,031,500","81,365,896"
1959,"1,186,000","81,365,896"
1960,"1,392,900","81,365,896"
1961,"1,592,300","81,365,896"
1962,"1,758,300","81,365,896"
1963,"1,750,200","81,365,896"
1964,"1,893,600","81,365,896"
1965,"1,986,100","81,365,896"
1966,"2,059,300","81,365,896"
1967,"1,905,200","81,365,896"
1968,"1,607,800","81,365,896"
1969,"1,658,500","81,365,896"
1970,"1,541,600","81,365,896"
1971,"1,518,500","81,365,896"
1972,"1,613,482","81,365,896"
1973,"1,446,500","81,365,896"
1974,"1,436,200","81,365,896"
1975,"1,064,500","81,365,896"
1976,"1,385,100","81,365,896"
1977,"1,230,900","81,365,896"
1978,"1,451,336","81,365,896"
1979,"1,304,790","81,365,896"
1980,"1,305,760","81,365,896"
1981,"1,359,061","81,365,896"
1982,"1,292,284","81,365,896"
1983,"1,212,736","81,365,896"
1984,"1,342,093","81,365,896"
1985,"1,229,062","81,365,896"
1986,"1,271,214","81,365,896"
1987,"1,300,983","81,365,896"
1988,"1,218,031","81,365,896"
1989,"1,136,662","81,365,896"
1990,"1,245,479","81,365,896"
1991,"1,168,736","81,365,896"
1992,"1,165,160","81,365,896"
1993,"1,080,030","81,365,896"
1994,"1,000,278","81,365,896"
1995,"943,098","81,365,896"
1996,"707,498","81,365,896"
1997,"841,218","81,365,896"
1998,"340,190","81,365,896"
1999,"553,420","81,365,896"
2000,"185,085","81,365,896"
2001,0,"81,365,896"
2002,"454,768","81,365,896"
2003,"529,985","81,365,896"
2004,"378,416","81,365,896"
2005,"467,550","81,365,896"
2006,"586,603","81,365,896"
2007,"591,081","81,365,896"
2008,"671,031","81,365,896"
2009,"676,002","81,365,896"
2010,"628,665","81,365,896"
2011,"430,153","81,365,896"
2012,0,"81,365,896"
2013,0,"81,365,896"
2014,"423,170","81,365,896"
2015,"493,550","81,365,896"
2016,"252,677","81,365,896"
2017,0,"81,365,896"
2018,0,"81,365,896"
')

# Get rid of the commas in the Recreation Visitors column
washingtonMonument$RecreationVisitors <- as.numeric(gsub(',', '', washingtonMonument$RecreationVisitors))

# Divide the Recreation Visitors column by one million to show the numbers in that column as millions
washingtonMonument$RecreationVisitors <- washingtonMonument$RecreationVisitors / 1000000

```


WASHINGTON MONUMENT EDA:
```{r}
plot(washingtonMonument$Year, washingtonMonument$RecreationVisitors, type = "b", main = "Washington Monument", ylab = "Visitors (in Millions)", xlab = "Year")

tail(washingtonMonument)
```



READ IN JEFFERSON MEMORIAL DATA:
Annual visitors since 1941
Data downloaded 1/25/20
```{r}
jeffersonMemorial <- read.csv(header = TRUE, stringsAsFactors = FALSE, text = '
Year,RecreationVisitors,TotalRecreationVisitors
1941,0,"114,225,543"
1942,"6,374","114,225,543"
1943,"528,527","114,225,543"
1944,"380,117","114,225,543"
1945,"443,595","114,225,543"
1946,"682,023","114,225,543"
1947,"639,200","114,225,543"
1948,"537,978","114,225,543"
1949,"554,435","114,225,543"
1950,"664,369","114,225,543"
1951,"911,120","114,225,543"
1952,"900,791","114,225,543"
1953,"812,070","114,225,543"
1954,"803,500","114,225,543"
1955,"754,500","114,225,543"
1956,"734,700","114,225,543"
1957,"834,800","114,225,543"
1958,"800,400","114,225,543"
1959,"782,000","114,225,543"
1960,"926,900","114,225,543"
1961,"811,500","114,225,543"
1962,"1,251,300","114,225,543"
1963,"1,423,200","114,225,543"
1964,"1,661,300","114,225,543"
1965,"1,699,400","114,225,543"
1966,"1,278,900","114,225,543"
1967,"1,375,000","114,225,543"
1968,"1,088,800","114,225,543"
1969,"1,261,100","114,225,543"
1970,"146,600","114,225,543"
1971,"1,279,800","114,225,543"
1972,"1,314,202","114,225,543"
1973,"1,319,400","114,225,543"
1974,"1,404,800","114,225,543"
1975,"1,632,700","114,225,543"
1976,"1,829,400","114,225,543"
1977,"1,696,200","114,225,543"
1978,"2,263,493","114,225,543"
1979,"2,328,095","114,225,543"
1980,"1,216,966","114,225,543"
1981,"1,788,267","114,225,543"
1982,"1,270,798","114,225,543"
1983,"1,485,531","114,225,543"
1984,"1,873,728","114,225,543"
1985,"2,261,477","114,225,543"
1986,"3,273,574","114,225,543"
1987,"1,818,622","114,225,543"
1988,"1,329,531","114,225,543"
1989,"923,811","114,225,543"
1990,"794,102","114,225,543"
1991,"655,444","114,225,543"
1992,"939,852","114,225,543"
1993,"714,095","114,225,543"
1994,"531,436","114,225,543"
1995,"588,051","114,225,543"
1996,"748,862","114,225,543"
1997,"953,408","114,225,543"
1998,"2,139,549","114,225,543"
1999,"2,218,837","114,225,543"
2000,"1,976,325","114,225,543"
2001,"2,225,756","114,225,543"
2002,"2,066,932","114,225,543"
2003,"1,642,293","114,225,543"
2004,"2,200,371","114,225,543"
2005,"2,312,726","114,225,543"
2006,"2,219,255","114,225,543"
2007,"2,327,254","114,225,543"
2008,"2,363,263","114,225,543"
2009,"2,337,868","114,225,543"
2010,"2,305,856","114,225,543"
2011,"1,945,696","114,225,543"
2012,"2,613,131","114,225,543"
2013,"2,609,463","114,225,543"
2014,"2,708,607","114,225,543"
2015,"3,102,442","114,225,543"
2016,"3,414,345","114,225,543"
2017,"3,366,571","114,225,543"
2018,"3,198,859","114,225,543"
')

# Get rid of the commas in the Recreation Visitors column
jeffersonMemorial$RecreationVisitors <- as.numeric(gsub(',', '', jeffersonMemorial$RecreationVisitors))

# Divide the Recreation Visitors column by one million to show the numbers in that column as millions
jeffersonMemorial$RecreationVisitors <- jeffersonMemorial$RecreationVisitors / 1000000

```


JEFFERSON MEMORIAL EDA:
```{r}
plot(jeffersonMemorial$Year, jeffersonMemorial$RecreationVisitors, type = "b", main = "Jefferson Memorial", ylab = "Visitors (in Millions)", xlab = "Year")

tail(jeffersonMemorial)
```


READ IN WRIGHT BROS MEMORIAL DATA:
Annual visitors since 1934
Data downloaded 1/25/20
```{r}
wrightBros <- read.csv(header = TRUE, stringsAsFactors = FALSE, text = '
Year,RecreationVisitors,TotalRecreationVisitors
1934,"17,010","27,884,483"
1935,"28,472","27,884,483"
1936,"48,690","27,884,483"
1937,"82,188","27,884,483"
1938,"80,911","27,884,483"
1939,"70,071","27,884,483"
1940,"54,729","27,884,483"
1941,"86,025","27,884,483"
1942,"11,319","27,884,483"
1943,"11,054","27,884,483"
1944,"8,592","27,884,483"
1945,"15,439","27,884,483"
1946,"49,512","27,884,483"
1947,"77,739","27,884,483"
1948,"72,984","27,884,483"
1949,"86,327","27,884,483"
1950,"111,116","27,884,483"
1951,"113,324","27,884,483"
1952,"153,072","27,884,483"
1953,"184,328","27,884,483"
1954,"184,500","27,884,483"
1955,"184,600","27,884,483"
1956,"305,500","27,884,483"
1957,"327,900","27,884,483"
1958,"241,100","27,884,483"
1959,"197,900","27,884,483"
1960,"237,600","27,884,483"
1961,"257,100","27,884,483"
1962,"223,600","27,884,483"
1963,"249,700","27,884,483"
1964,"296,800","27,884,483"
1965,"302,700","27,884,483"
1966,"370,900","27,884,483"
1967,"340,000","27,884,483"
1968,"310,400","27,884,483"
1969,"324,900","27,884,483"
1970,"489,400","27,884,483"
1971,"392,300","27,884,483"
1972,"423,725","27,884,483"
1973,"413,600","27,884,483"
1974,"472,700","27,884,483"
1975,"485,200","27,884,483"
1976,"505,000","27,884,483"
1977,"535,000","27,884,483"
1978,"481,140","27,884,483"
1979,"396,322","27,884,483"
1980,"428,809","27,884,483"
1981,"429,618","27,884,483"
1982,"415,360","27,884,483"
1983,"484,289","27,884,483"
1984,"409,493","27,884,483"
1985,"448,677","27,884,483"
1986,"630,779","27,884,483"
1987,"315,957","27,884,483"
1988,"328,617","27,884,483"
1989,"472,894","27,884,483"
1990,"463,461","27,884,483"
1991,"461,494","27,884,483"
1992,"477,643","27,884,483"
1993,"477,362","27,884,483"
1994,"475,755","27,884,483"
1995,"434,671","27,884,483"
1996,"393,721","27,884,483"
1997,"425,132","27,884,483"
1998,"419,210","27,884,483"
1999,"375,681","27,884,483"
2000,"429,472","27,884,483"
2001,"438,548","27,884,483"
2002,"440,737","27,884,483"
2003,"712,181","27,884,483"
2004,"421,341","27,884,483"
2005,"458,948","27,884,483"
2006,"466,144","27,884,483"
2007,"494,331","27,884,483"
2008,"527,721","27,884,483"
2009,"476,291","27,884,483"
2010,"476,200","27,884,483"
2011,"445,455","27,884,483"
2012,"466,816","27,884,483"
2013,"447,796","27,884,483"
2014,"430,517","27,884,483"
2015,"437,184","27,884,483"
2016,"458,776","27,884,483"
2017,"414,244","27,884,483"
2018,"360,669","27,884,483"
')

# Get rid of the commas in the Recreation Visitors column
wrightBros$RecreationVisitors <- as.numeric(gsub(',', '', wrightBros$RecreationVisitors))

# Divide the Recreation Visitors column by one million to show the numbers in that column as millions
wrightBros$RecreationVisitors <- wrightBros$RecreationVisitors / 1000000

```


WRIGHT BROS MEMORIAL EDA:
```{r}
plot(wrightBros$Year, wrightBros$RecreationVisitors, type = "b", main = "Wright Bros Memorial", ylab = "Visitors (in Millions)", xlab = "Year")

tail(wrightBros)
```


READ IN ACADIA DATA:
Annual visitors since 1919
Data downloaded 1/25/20
```{r}
acadia <- read.csv(header = TRUE, stringsAsFactors = FALSE, text = '
Year,RecreationVisitors,TotalRecreationVisitors
1919,"64,000","170,559,038"
1920,"66,500","170,559,038"
1921,"69,836","170,559,038"
1922,"73,779","170,559,038"
1923,"64,200","170,559,038"
1924,"71,758","170,559,038"
1925,"73,673","170,559,038"
1926,"101,256","170,559,038"
1927,"123,699","170,559,038"
1928,"134,897","170,559,038"
1929,"149,554","170,559,038"
1930,"154,734","170,559,038"
1931,"162,238","170,559,038"
1932,"237,596","170,559,038"
1933,"262,712","170,559,038"
1934,"275,956","170,559,038"
1935,"316,114","170,559,038"
1936,"340,393","170,559,038"
1937,"383,036","170,559,038"
1938,"394,319","170,559,038"
1939,"396,468","170,559,038"
1940,"382,084","170,559,038"
1941,"409,961","170,559,038"
1942,"36,544","170,559,038"
1943,"8,246","170,559,038"
1944,"12,916","170,559,038"
1945,"20,200","170,559,038"
1946,"382,390","170,559,038"
1947,"434,069","170,559,038"
1948,"420,846","170,559,038"
1949,"438,584","170,559,038"
1950,"485,220","170,559,038"
1951,"518,556","170,559,038"
1952,"549,075","170,559,038"
1953,"556,195","170,559,038"
1954,"553,800","170,559,038"
1955,"655,000","170,559,038"
1956,"735,500","170,559,038"
1957,"858,900","170,559,038"
1958,"816,500","170,559,038"
1959,"755,900","170,559,038"
1960,"1,638,200","170,559,038"
1961,"1,574,600","170,559,038"
1962,"1,601,500","170,559,038"
1963,"1,864,800","170,559,038"
1964,"2,011,600","170,559,038"
1965,"1,733,600","170,559,038"
1966,"2,158,400","170,559,038"
1967,"2,102,000","170,559,038"
1968,"2,303,300","170,559,038"
1969,"2,489,800","170,559,038"
1970,"2,776,300","170,559,038"
1971,"2,101,100","170,559,038"
1972,"2,285,881","170,559,038"
1973,"2,394,000","170,559,038"
1974,"2,335,800","170,559,038"
1975,"2,380,500","170,559,038"
1976,"2,353,300","170,559,038"
1977,"2,734,600","170,559,038"
1978,"2,684,933","170,559,038"
1979,"2,787,366","170,559,038"
1980,"2,779,666","170,559,038"
1981,"2,997,972","170,559,038"
1982,"3,572,114","170,559,038"
1983,"4,124,639","170,559,038"
1984,"3,734,763","170,559,038"
1985,"3,745,570","170,559,038"
1986,"3,929,054","170,559,038"
1987,"4,288,154","170,559,038"
1988,"4,502,283","170,559,038"
1989,"5,440,952","170,559,038"
1990,"2,339,591","170,559,038"
1991,"2,475,857","170,559,038"
1992,"2,382,113","170,559,038"
1993,"2,656,034","170,559,038"
1994,"2,710,749","170,559,038"
1995,"2,845,378","170,559,038"
1996,"2,704,831","170,559,038"
1997,"2,760,306","170,559,038"
1998,"2,594,497","170,559,038"
1999,"2,602,227","170,559,038"
2000,"2,469,238","170,559,038"
2001,"2,516,551","170,559,038"
2002,"2,558,572","170,559,038"
2003,"2,431,062","170,559,038"
2004,"2,207,847","170,559,038"
2005,"2,051,484","170,559,038"
2006,"2,083,588","170,559,038"
2007,"2,202,228","170,559,038"
2008,"2,075,857","170,559,038"
2009,"2,227,698","170,559,038"
2010,"2,504,208","170,559,038"
2011,"2,374,645","170,559,038"
2012,"2,431,052","170,559,038"
2013,"2,254,922","170,559,038"
2014,"2,563,129","170,559,038"
2015,"2,811,184","170,559,038"
2016,"3,303,393","170,559,038"
2017,"3,509,271","170,559,038"
2018,"3,537,575","170,559,038"
')

# Get rid of the commas in the Recreation Visitors column
acadia$RecreationVisitors <- as.numeric(gsub(',', '', acadia$RecreationVisitors))

# Divide the Recreation Visitors column by one million to show the numbers in that column as millions
acadia$RecreationVisitors <- acadia$RecreationVisitors / 1000000

```


ACADIA EDA:
```{r}
plot(acadia$Year, acadia$RecreationVisitors, type = "b", main = "Acadia National Park", ylab = "Visitors (in Millions)", xlab = "Year")

tail(acadia)
```

READ IN LINCOLN MEMORIAL DATA
Annual visitors since 1936
Data downloaded 1/25/20
```{r}
lincolnMemorial <- read.csv(header = TRUE, stringsAsFactors = FALSE, text = '
Year,RecreationVisitors,TotalRecreationVisitors
1936,"857,441","254,381,182"
1937,"1,252,438","254,381,182"
1938,"1,215,961","254,381,182"
1939,"1,079,367","254,381,182"
1940,"1,538,573","254,381,182"
1941,"1,768,810","254,381,182"
1942,"666,524","254,381,182"
1943,"519,640","254,381,182"
1944,"738,945","254,381,182"
1945,"544,186","254,381,182"
1946,"995,957","254,381,182"
1947,"1,325,150","254,381,182"
1948,"1,516,834","254,381,182"
1949,"1,668,779","254,381,182"
1950,"2,065,586","254,381,182"
1951,"1,675,751","254,381,182"
1952,"1,793,048","254,381,182"
1953,"1,718,168","254,381,182"
1954,"1,688,400","254,381,182"
1955,"1,650,400","254,381,182"
1956,"1,850,300","254,381,182"
1957,"2,305,400","254,381,182"
1958,"1,978,500","254,381,182"
1959,"2,054,900","254,381,182"
1960,"2,488,200","254,381,182"
1961,"2,890,000","254,381,182"
1962,"2,672,300","254,381,182"
1963,"3,461,100","254,381,182"
1964,"4,016,900","254,381,182"
1965,"4,039,900","254,381,182"
1966,"4,690,700","254,381,182"
1967,"3,519,600","254,381,182"
1968,"3,479,100","254,381,182"
1969,"3,874,500","254,381,182"
1970,"2,782,000","254,381,182"
1971,"2,330,700","254,381,182"
1972,"1,989,112","254,381,182"
1973,"2,422,500","254,381,182"
1974,"2,827,600","254,381,182"
1975,"4,351,900","254,381,182"
1976,"4,352,900","254,381,182"
1977,"2,350,900","254,381,182"
1978,"2,424,478","254,381,182"
1979,"3,352,343","254,381,182"
1980,"3,307,585","254,381,182"
1981,"2,989,487","254,381,182"
1982,"3,131,753","254,381,182"
1983,"3,352,825","254,381,182"
1984,"3,963,471","254,381,182"
1985,"3,810,581","254,381,182"
1986,"3,972,460","254,381,182"
1987,"4,308,292","254,381,182"
1988,"2,787,270","254,381,182"
1989,"1,462,609","254,381,182"
1990,"1,265,085","254,381,182"
1991,"1,141,278","254,381,182"
1992,"1,237,659","254,381,182"
1993,"1,258,534","254,381,182"
1994,"1,200,094","254,381,182"
1995,"1,291,628","254,381,182"
1996,"1,190,961","254,381,182"
1997,"1,557,964","254,381,182"
1998,"4,368,912","254,381,182"
1999,"4,099,480","254,381,182"
2000,"4,009,145","254,381,182"
2001,"3,968,357","254,381,182"
2002,"3,551,973","254,381,182"
2003,"3,272,596","254,381,182"
2004,"3,988,650","254,381,182"
2005,"3,638,806","254,381,182"
2006,"3,810,347","254,381,182"
2007,"4,214,167","254,381,182"
2008,"4,678,861","254,381,182"
2009,"5,255,570","254,381,182"
2010,"6,042,315","254,381,182"
2011,"5,971,220","254,381,182"
2012,"6,191,361","254,381,182"
2013,"6,546,518","254,381,182"
2014,"7,139,072","254,381,182"
2015,"7,941,771","254,381,182"
2016,"7,915,934","254,381,182"
2017,"7,956,117","254,381,182"
2018,"7,804,683","254,381,182"
')

# Get rid of the commas in the Recreation Visitors column
lincolnMemorial$RecreationVisitors <- as.numeric(gsub(',', '', lincolnMemorial$RecreationVisitors))

# Divide the Recreation Visitors column by one million to show the numbers in that column as millions
lincolnMemorial$RecreationVisitors <- lincolnMemorial$RecreationVisitors / 1000000

```



LINCOLN MEMORIAL EDA:
```{r}
plot(lincolnMemorial$Year, lincolnMemorial$RecreationVisitors, type = "b", main = "Lincoln Memorial", ylab = "Visitors (in Millions)", xlab = "Year")

tail(lincolnMemorial)
```


ANALYSIS ON LINCOLD MEMORIAL:

ARIMA has two requirements: additive and constant mean
clear that the mean isn't constant over the full series
consider filtering

FILTERING & GRAPHIC
```{r}
lincoln2003 <- subset(lincolnMemorial, Year>2002)

#confirm
plot(lincoln2003$Year, lincoln2003$RecreationVisitors, type = "b", main = "Lincoln Memorial Visitors Since 2003", ylab = "Visitors (in Millions)", xlab = "Year")

```


CREATE MODEL:
```{r}
#Model: ARIMA(1,1,1)
# features: mean change year-to-year, long memory, short memory

#fit model, report parameter estimates & std errors,and predictions & prediction intervals

#add library astsa
library (astsa)

lincoln.out <- sarima(lincoln2003$RecreationVisitors, 1,1,1)

lincoln.out$ttable
```


5 YEAR PREDICTION & CONFIDENCE INTERVALS:
```{r}
#predict next 5 years
lincoln.future <- sarima.for(lincoln2003$RecreationVisitors, 1,1,1, n.ahead = 5)

# prediction interval for transformed response variable
lincoln.future.L <- lincoln.future$pred - (2 * lincoln.future$se)
lincoln.future.U <- lincoln.future$pred + (2 * lincoln.future$se)

#table of predictions and 95% prediction intervals (undo ln)
cbind(lincoln.future$pred, lincoln.future.L, lincoln.future.U)

```


ANOTHER DATA GRAPHIC:
```{r}
plot(lincoln2003$Year, lincoln2003$RecreationVisitors, type = "b", 
     main = "Lincoln Memorial Predicted Visitors", ylab = "Visitors (in Millions)", xlab = "Year",
     xlim = c(2010,2025), ylim = c(4,12))
lines(2019:2023, lincoln.future$pred, type = "b", pch = 19, col="navyblue")
lines(2019:2023, lincoln.future.L, lty = 2, col="green")
lines(2019:2023, lincoln.future.U, lty = 2, col="green")

```
